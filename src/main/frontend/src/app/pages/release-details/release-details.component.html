<div class="release-details-container">
  @if (!isLoading && release) {
    <div class="release-details-header">
      <div class="header-actions">
        <button class="back-button" (click)="goBack()">
          <img src="assets/icons/chevron-left.svg" alt="" width="20" height="20" />
          Back
        </button>
        @if (authService.currentUser()?.isFrankFrameworkMember) {
          <button class="manage-button" [routerLink]="['/release-manage', release.id]">Manage</button>
        }
      </div>
      <div class="header-details">
        <h2>{{ release.name }}</h2>
        <span>{{ release.publishedAt | date: 'longDate' }}</span>
      </div>
    </div>

    <div class="release-details-body">
      <div class="release-details-content">
        <div class="left-panel">
          @if (highlightedLabels === undefined && releaseIssues === undefined) {
            <div class="no-new-features">
              <p>No new features found towards previous release.</p>
              <p>Please try again later.</p>
            </div>
          } @else {
            @if (highlightedLabels) {
              <app-release-highlights [highlightedLabels]="highlightedLabels" [releaseIssues]="releaseIssues" />
            } @else {
              <div class="no-highlights">
                <p>No new highlights found for this release.</p>
              </div>
            }

            <div class="section-toggle-container">
              <label class="section-toggle" [class.active]="showBusinessValue()">
                <input type="checkbox" [checked]="showBusinessValue()" (change)="toggleBusinessValue()" />
                <span class="toggle-label">Business Values</span>
              </label>
              <label class="section-toggle" [class.active]="showImportantIssues()">
                <input type="checkbox" [checked]="showImportantIssues()" (change)="toggleImportantIssues()" />
                <span class="toggle-label">Important Issues</span>
              </label>
            </div>

            @if (showBusinessValue()) {
              <div class="section-content" [class.last-section]="!showImportantIssues()">
                <app-release-business-value [releaseId]="release.id" />
              </div>
            }

            @if (releaseIssues && showImportantIssues()) {
              <div class="section-content last-section">
                <app-release-important-issues [releaseIssues]="releaseIssues" [releaseId]="release.id" />
              </div>
            }
          }
        </div>

        <div class="right-panel">
          @if (vulnerabilities !== undefined) {
            <app-release-vulnerabilities [vulnerabilities]="vulnerabilities" />
          } @else {
            <div class="placeholder">
              <p>Loading vulnerability information...</p>
            </div>
          }
        </div>
      </div>
    </div>
  } @else if (isLoading) {
    <app-loader />
  }
</div>
