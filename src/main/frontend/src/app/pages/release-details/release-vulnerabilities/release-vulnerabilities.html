<div class="vulnerabilities-container">
  <div class="cve-list">
    @if (sortedVulnerabilities.length === 0) {
      <p class="no-vulnerabilities">No vulnerabilities found for this release.</p>
    } @else {
      <h3 class="vulnerabilities-title">Vulnerabilities ({{ sortedVulnerabilities.length }})</h3>
      @for (vulnerability of sortedVulnerabilities; track vulnerability.cveId) {
        <div
          class="cve-item"
          tabindex="0"
          role="button"
          [class.selected]="selectedVulnerability?.cveId === vulnerability.cveId && isOffCanvasOpen"
          (click)="selectVulnerability(vulnerability)"
          (keydown.enter)="selectVulnerability(vulnerability)"
          (keydown.space)="selectVulnerability(vulnerability)"
        >
          <div class="cve-header">
            <span class="cve-id">{{ vulnerability.cveId }}</span>
            <span class="severity-badge" [ngClass]="getSeverityClass(vulnerability.severity)">
              {{ vulnerability.severity }}
            </span>
          </div>
          <div class="cve-score">CVSS Score: {{ formatCvssScore(vulnerability.cvssScore) }}</div>
        </div>
      }
    }
  </div>

  @if (isOffCanvasOpen) {
    <app-vulnerability-details-off-canvas
      [vulnerability]="selectedVulnerability"
      (closeVulnerabilityCanvas)="closeOffCanvas()"
    />
  }
</div>
