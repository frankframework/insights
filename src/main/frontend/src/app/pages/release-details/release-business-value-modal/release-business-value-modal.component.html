<app-modal [title]="businessValue()?.title || 'Business Value Details'" (closed)="close()">
  <div class="business-value-modal-content">
    @if (businessValue()) {
      <div class="business-value-details">
        <section class="description-section">
          <h3>Description</h3>
          <p class="description-text">{{ businessValue()!.description }}</p>
        </section>

        <section class="issues-section">
          <div class="issues-header">
            <h3>Connected Issues</h3>
            <span class="issue-count"
              >{{ businessValue()!.issues?.length || 0 }} issue{{
                businessValue()!.issues?.length === 1 ? '' : 's'
              }}</span
            >
          </div>

          @if (businessValue()!.issues && businessValue()!.issues!.length > 0) {
            <div class="issues-tree">
              @for (issue of businessValue()!.issues; track issue.id) {
                <div
                  class="issue-tree-item"
                  role="button"
                  tabindex="0"
                  (click)="openIssue(issue)"
                  (keydown.enter)="openIssue(issue)"
                  (keydown.space)="openIssue(issue)"
                >
                  <app-issue-tree-branch [issue]="issue" [depth]="0" />
                </div>
              }
            </div>
          } @else {
            <div class="no-issues">
              <p>No issues connected to this business value.</p>
            </div>
          }
        </section>
      </div>
    }
  </div>
</app-modal>
