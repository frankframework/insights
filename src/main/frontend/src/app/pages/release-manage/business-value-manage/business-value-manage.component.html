<div class="business-value-manage-container">
  @if (showCreateForm()) {
    <app-business-value-add (closed)="toggleCreateForm()" (businessValueCreated)="onBusinessValueCreated($event)" />
  }

  @if (showEditForm() && selectedBusinessValue()) {
    <app-business-value-edit
      [businessValue]="selectedBusinessValue()!"
      (closed)="toggleEditForm()"
      (businessValueUpdated)="onBusinessValueUpdated($event)"
    />
  }

  @if (showDeleteForm() && businessValueToDelete()) {
    <app-business-value-delete
      [businessValue]="businessValueToDelete()!"
      (closed)="closeDeleteModal()"
      (businessValueDeleted)="onBusinessValueDeleted($event)"
    />
  }

  @if (!isLoading()) {
    <div class="header">
      <button class="back-button" (click)="goBack()">
        <img src="assets/icons/chevron-left.svg" alt="" width="20" height="20" />
        Back to Overview
      </button>

      <div class="header-titles">
        <h1>{{ releaseTitle() }}</h1>
        <p class="subtitle">Manage Business Values</p>
      </div>
    </div>

    <div class="content">
      <app-business-value-panel
        [businessValues]="businessValues()"
        [selectedBusinessValue]="selectedBusinessValue()"
        (businessValueSelected)="selectBusinessValue($event)"
        (createClicked)="toggleCreateForm()"
        (editClicked)="toggleEditForm()"
        (deleteClicked)="openDeleteModal($event.businessValue, $event.event)"
      />

      <app-business-value-issue-panel
        [selectedBusinessValue]="selectedBusinessValue()"
        [issuesWithSelection]="issuesWithSelection()"
        [hasChanges]="hasChanges()"
        [isSaving]="isSaving()"
        (issueToggled)="toggleIssue($event)"
        (saveClicked)="saveChanges()"
      />
    </div>
  } @else {
    <app-loader />
  }
</div>
